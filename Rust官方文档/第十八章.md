# 第十八章

# 模式匹配

## 模式

* 模式是Rust中的一种特殊语法，用于匹配复杂和简单类型的结构
* 将模式与匹配表达式和其他构造结合使用。可以更好地控制程序的控制流
* 模式由以下元素（的一些组合）组成：
  * 字面值
  * 解构的数组、enum、struct和tuple
  * 变量
  * 通配符
  * 占位符
* 想要使用模式，需要将其与某个值进行比较：
  * 如果模式匹配，就可以在代码中使用这个值的相应部分

## 18.1 用到模式的地方

### match的Arm

```rust
match VALUE{
		PATTERN => EXPRESSION,
  	PATTERN => EXPRESSION,
  	PATTERN => EXPRESSION,
}
```

* match表达式的要求：
  * 详尽（包含所有的可能性）
* 一个特殊的模式：_（下划线）：
  * 它会匹配任何东西
  * 不会绑定到变量
  * 通常用于match的最后一个arm：或用于忽略某些值。

### 条件if let表达式

* if let表达式主要是作为一种简短的方式来等价的代替只有一个匹配项的match

* if let可选的可以拥有else, 包括：

  ​	-else if

  ​	-else let

* 但if let不会检查穷尽性

### while let条件循环

* 只要模式继续满足匹配的条件，那它允许while循环一直运行

### for循环

* for循环是Rust中最常见的循环
* for循环中，模式就是紧随for关键字后的值

### let语句

* let语句也是模式
* let PATTERN = EXPRESSION:

### 函数参数

* 函数参数也可以是模式



## 18.2 可辩驳性： 模式是否会无法匹配

### 模式的两种形式

* 模式由两种形式：可辩驳的、不可辩驳的
* 能匹配任何可能传递的值的模式：无可辩驳的
  * 例如：let x = 5;
* 对某些可能的值，无法进行匹配的模式：可辩驳的
  * 例如： if let Some(x) = a_value
* 函数参数、let语句、for循环只接受无可辩驳的模式
* if let和while let接受可辩驳和无可辩驳的模式



## 18.3 模式语法

### 匹配字面值

* 模式可直接匹配字面值

### 匹配命名变量

* 命名的变量是可匹配任何值的无可辩驳模式

### 多重模式

* 在match表达式中，使用|语法（就是或的意思），可以匹配多种模式

### 使用 ..=来匹配某个范围的值

### 解构以分解值

* 可以使用模式来解构struct、enum、tuple，从而引用这些类型值的不同部分

### 解构枚举

### 解构嵌套的struct和enum

### 解构struct和tuple

### 在模式中忽略值

* 有几种方式可以在模式中忽略整个值或部分值：
  * _
  * _配合其他模式
  * 使用以_开头的名称
  * ..（忽略值的剩余部分）

### 使用_来忽略整个值

### 使用嵌套的_来忽略值的一部分

### 通过使用_开头命名来忽略未使用的变量

### 使用..来忽略值的剩余部分

### 使用match守卫来提供额外的条件

* match守卫就是match arm模式后额外的if条件，想要匹配该条件也必须满足
* match守卫适用于比单独的模式更复杂的场景

### @绑定

* @符号让我们可以创建一个变量，该变量可以在测试某个值是否与模式匹配的同时保存该值





